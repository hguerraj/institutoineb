import{enableSelectModal}from"./core-functions.js";const enableReadPaginated=function(){$('input[name^="rp_others_"]').on("change",(function(){const e=$(this).closest("div.form-group").siblings(".skippable");"skip"===$(this).val()?e.slideUp():e.slideDown()})),$('input[name^="rp_others_"]:checked').trigger("change"),$('select[name^="rp_value_type_"]').add('input[name^="rp_value_type_"]').on("change",(function(){const e=$(this).val(),t=$(this).closest("div.row"),n=t.find('select[name^="rp_jedit_"]').attr("name");"array"==e||"image"==e||"file"==e||"password"==e||$(this).attr("data-multiple")?(window.slimSelects[n].set(""),window.slimSelects[n].disable(),t.find("label").addClass("disabled")):(window.slimSelects[n].enable(),t.find("label").removeClass("disabled"))})),setTimeout((()=>{$('select[name^="rp_value_type_"]').trigger("change")}),3e3),$('input[name^="bulk_constrained_tables_"]')[0]&&($('input[name^="bulk_constrained_tables_"]').on("change",(function(){const e=$(this).attr("id").replace("bulk_","");$("#"+e).prop("checked",!0)})),$('input[name^="constrained_tables_"]').on("change",(function(){const e="bulk_"+$(this).attr("id");$("#"+e).prop("checked",!0)}))),enableSelectModal("rp_jedit_select_modal");const e=$("#filters-ajax-elements-container");let t=$('input[name="filters-dynamic-fields-index"]'),n=parseInt(t.val());const a=function(){$(".filters-remove-element-button").removeClass("hidden").off("click").on("click",(function(){let e=parseInt($(this).attr("data-index"));const a=function(){const t=$('.filters-dynamic[data-index="'+e+'"]'),n=$(t).find('input:not([type="search"]), textarea, select, radio, checkbox');$(n).each((function(t,n){if(void 0===$(n).attr("data-activates")){let t=$(n).attr("id"),a="",l="";if($(n).is('input[type="radio"]')){let t=$(n).attr("name").replace("-"+parseInt(e),"-"+parseInt(e+1));a=$('input[name="'+t+'"]:checked'),l=a.val(),$(n).val()==l?$(n).prop("checked",!0):$(n).prop("checked",!1);const i="#filters-ajax-elements-"+e+" .hidden-wrapper";phpfbDependentFields[i]=new DependentFields(i),window.CustomEvent&&"function"==typeof window.CustomEvent?document.querySelector(i).dispatchEvent(new CustomEvent("change")):document.querySelector(i).dispatchEvent(document.createEvent("CustomEvent").initCustomEvent("change",!0,!0))}else{const i=t.replace("-"+parseInt(e),"-"+parseInt(e+1));a=$("#"+i),$(n).is("select")?(l=a.find("option:selected").val(),window.slimSelects[t].set(l)):(l=a.val(),$(n).val(l))}}}))};if($(".filters-dynamic")[e])for(;$($(".filters-dynamic")[e+1]).length>0;)a(),e++;n-=1,t.val(n),l(),$(".filters-remove-element-button:last").closest(".filters-dynamic").remove()}))},l=function(){$('input[name^="filter-daterange-"]').off("change").on("change",(function(e){const t=$(e.target).attr("name").replace("filter-daterange-","");$(e.target).val()>0?($('input[name="filter-ajax-'+t+'"][value=""]').prop("checked",!0),$('input[name="filter-ajax-'+t+'"]').prop("disabled",!0)):$('input[name="filter-ajax-'+t+'"]').prop("disabled",!1)})),$('input[name^="filter-mode-"]').on("change",(function(e){const t=$(e.target).attr("name").replace("filter-mode-","");"advanced"===$(e.target).val()?$('input[name="filter-ajax-'+t+'"]').prop("disabled",!1):$('input[name="filter-daterange-'+t+'"]:checked').trigger("change")}))};$(".filters-add-element-button").on("click",(function(){n++,t.val(n),$.ajax({url:generatorUrl+"inc/filters-dynamic-elements.php",data:{index:n}}).done((function(t){e.append(t),$("#filters-ajax-elements-container").find('div[data-index="'+n+'"]').attr("id","filters-ajax-elements-"+n);const o=window.run;void 0!==o&&setTimeout(o,0),phpfbDependentFields["#filters-ajax-elements-container"]=new DependentFields("#filters-ajax-elements-container .hidden-wrapper"),window.enablePrettyCheckbox("#filters-ajax-elements-"+n);const s=$("#filters-ajax-elements-"+n).find("select").attr("id");window.slimSelects[s]=new SlimSelect({select:"#"+s}),a(),i(),l()})).fail((function(e,t,n){console.log(n)}))})),a(),l(),$('input[name^="filter-daterange-"]').each((function(){$(this).is(":checked")&&$(this).trigger("change")}));const i=function(){$('button[name^="filter_test-"]')[0]&&$('button[name^="filter_test-"]').off("click").on("click",(function(){const e=$(this).val(),t="test_filter_"+e;let n={};n[t]="all",$('select[name="test_filter_'+e+'"]')[0]&&(n[t]=$('select[name="test_filter_'+e+'"]').val()),n.index=e,n.filter_mode=$('input[name="filter-mode-'+e+'"]:checked').val(),n.filter_A=$('select[name="filter_field_A-'+e+'"]').val(),n.select_label=$('input[name="filter_select_label-'+e+'"]').val(),n.option_text=$('input[name="filter_option_text-'+e+'"]').val(),n.fields=$('input[name="filter_fields-'+e+'"]').val(),n.field_to_filter=$('input[name="filter_field_to_filter-'+e+'"]').val(),n.from=$('input[name="filter_from-'+e+'"]').val(),n.type=$('input[name="filter_type-'+e+'"]').val(),$.ajax({url:generatorUrl+"inc/filter-test.php",type:"POST",data:n}).done((function(e){$("#ajax-modal .modal-content").html(e),setTimeout((()=>{$("#ajax-modal .modal-content .db-error")[0]&&$("#ajax-modal .modal-body").prepend($("#ajax-modal .modal-content .db-error"))}),0),window.enablePrettyCheckbox("#ajax-modal"),window.ajaxModal.open(),$('#ajax-modal button[name="cancel_filters"]').attr("disabled",!0),$('#ajax-modal button[name="submit_filters"]').attr("disabled",!0)})).fail((function(e,t,n){console.log(n)}))}))};i(),$('select[name^="rp_target_column_"]').on("change",(function(){let e=$(this).attr("name").replace("rp_target_column_0","rp_target_column_1");new RegExp(/rp_target_column_1/).test($(this).attr("name"))&&(e=$(this).attr("name").replace("rp_target_column_1","rp_target_column_0"));const t=$(this).val(),n=$($("#"+e)).val(),a=$(this).attr("name").replace(/target_column_[0-9]+/,"jedit"),l=$('select[name="'+a+'"]').closest("div.row"),i=new RegExp(/\./);i.test(t)||i.test(n)?(window.slimSelects[a].set(""),window.slimSelects[a].disable(),l.find("label").addClass("disabled")):(window.slimSelects[a].enable(),l.find("label").removeClass("disabled"))})),setTimeout((()=>{$('select[name^="rp_target_column_0"]').trigger("change")}),3e3)};export{enableReadPaginated};